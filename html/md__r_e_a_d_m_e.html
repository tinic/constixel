<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: constixel</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">My Project
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__r_e_a_d_m_e.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">constixel</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<p><a href="https://github.com/tinic/constixel/actions/workflows/cmake-multi-platform.yml"><img src="https://github.com/tinic/constixel/actions/workflows/cmake-multi-platform.yml/badge.svg" alt="CMake on multiple platforms" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/tinic/constixel/actions/workflows/codeql.yml"><img src="https://github.com/tinic/constixel/actions/workflows/codeql.yml/badge.svg" alt="CodeQL Advanced" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/tinic/constixel/actions/workflows/msvc.yml"><img src="https://github.com/tinic/constixel/actions/workflows/msvc.yml/badge.svg" alt="Microsoft C++ Code Analysis" style="pointer-events: none;" class="inline"/></a></p>
<p>constixel is a single header minimalistic constexpr C++20 2D graphics palette based rendering library with the ability to output to a sixel image stream which can be viewed in most modern terminals.</p>
<h4><a class="anchor" id="autotoc_md1"></a>
Table of Contents</h4>
<p>Primary features and goals <br  />
 Applications <br  />
 Requirements <br  />
 Minimal example <br  />
 Text drawing example <br  />
 Consteval sixel example <br  />
 Consteval image example <br  />
 Saving a PNG to disk example <br  />
 API <br  />
</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Primary features and goals</h1>
<ul>
<li>Completely constexpr. All operations, including the sixel output stream can be generated during compilation.</li>
<li>No dynamic allocations. The backbuffer and the very few internal data structures can live as global static variables.</li>
<li>Minimalistic interface and single header implementation so it can be used without fuzz in any modern C++ project.</li>
<li>1, 2, 4 and 8bit palette based back buffers for minimal memory usage. Reasonable standard palettes are provided.</li>
<li>Simple fill_rect, fill_round_rect, line and fill_circle drawing functions.</li>
<li>Render proportional text, optionally with kerning, using fonts genenerated by a custom version of fontbm. Repository includes a set of pre-made fonts which are trivial to use. UTF-8 is supported.</li>
<li>A simplistic uncompressed png encoder is included to reduce dependencies.</li>
<li>Blit raw 32-bit RGBA image buffers into the palette backed back buffer (with or without dithering). Also convert into a RGBA buffer when needed.</li>
<li>Code is cpplint compliant, passes cppcheck and is of course consteval runnable.</li>
<li>Code compiles with "-Wall -Wextra -Wpedantic -Weffc++ -Werror" on so it can be easily used in any existing C++ project without creating noise.</li>
<li>Various other simple image manipulation operations.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>This library is not designed for high fidelity graphics generation and should be more thought of a utility library for software development purposes. Despite that, on HiDPI screens like on Macs the results generally look fairly good.</dd></dl>
<h1><a class="anchor" id="autotoc_md3"></a>
Applications</h1>
<ul>
<li>Interface rendering on embedded devices.</li>
<li>Send graphical data to your terminal through a serial or ssh connections from embedded or remote device.</li>
<li>Add graphical output to unit tests.</li>
<li>Programmatically render static graphical assets.</li>
<li>Help debug dynamic memory handling issues in complex C++ projects.</li>
<li>...</li>
</ul>
<h1><a class="anchor" id="autotoc_md4"></a>
Requirements</h1>
<ul>
<li>C++20, i.e. gcc 13.3 or newer, clang 16 or newer, MSVC 17 or newer</li>
<li>For viewing the sixel image you will need a sixel capable terminal. Windows Terminal, iTerm2 on MacOS and <a href="https://www.arewesixelyet.com/">some</a> Linux terminals will work. In Visual Studio Code sixel rendering can be enabled for all terminals using the <code>"terminal.integrated.enableImages": true</code> setting. There is also an option to output to a <a href="https://sw.kovidgoyal.net/kitty/graphics-protocol/">kitty</a> graphics enabled terminal.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>The Terminal app on MacOS does not support sixel, please use iTerm2.</dd>
<dd>
If you want to consteval either the sixel or image data you likely need to increase the constexpr ops limit. With g++ use '-fconstexpr-ops-limit=268435456' with clang use '-fconstexpr-steps=33554432'. The default limit in MSVC usually seems adequate.</dd></dl>
<h1><a class="anchor" id="autotoc_md5"></a>
Minimal example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;constixel.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_8bit, 256, 256&gt;</a> image;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (int32_t y = 0; y &lt; 16; y++) {</div>
<div class="line">        <span class="keywordflow">for</span> (int32_t x = 0; x &lt; 16; x++) {</div>
<div class="line">            image.<a class="code hl_function" href="classconstixel_1_1image.html#abd5c930c3645cb7b5ead82bad22dc7cb">fill_rect</a>(x * 16, y * 16, 16, 16, <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>(y * 16 + x));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    image.<a class="code hl_function" href="classconstixel_1_1image.html#a58ede242948ae8c59879c8165c43ab49">sixel_to_cout</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassconstixel_1_1image_html"><div class="ttname"><a href="classconstixel_1_1image.html">constixel::image</a></div><div class="ttdoc">Core class of constixel, holds a buffer of an image of a certain size and format.</div><div class="ttdef"><b>Definition</b> constixel.h:1633</div></div>
<div class="ttc" id="aclassconstixel_1_1image_html_a58ede242948ae8c59879c8165c43ab49"><div class="ttname"><a href="classconstixel_1_1image.html#a58ede242948ae8c59879c8165c43ab49">constixel::image::sixel_to_cout</a></div><div class="ttdeci">void sixel_to_cout() const</div><div class="ttdoc">Convert the current instance into a sixel stream and output it to std::cout.</div><div class="ttdef"><b>Definition</b> constixel.h:2394</div></div>
<div class="ttc" id="aclassconstixel_1_1image_html_abd5c930c3645cb7b5ead82bad22dc7cb"><div class="ttname"><a href="classconstixel_1_1image.html#abd5c930c3645cb7b5ead82bad22dc7cb">constixel::image::fill_rect</a></div><div class="ttdeci">constexpr void fill_rect(int32_t x, int32_t y, int32_t w, int32_t h, uint8_t col)</div><div class="ttdoc">Draw a fill rectangle with the specified color.</div><div class="ttdef"><b>Definition</b> constixel.h:2109</div></div>
</div><!-- fragment --><p><img src="./media/constixel.jpg" alt="constixel" title="Example in iTerm" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md6"></a>
Text drawing example</h1>
<p>Include a text font and pass the struct name as a template parameter to the draw_string function:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;constixel.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;fonts/ibmplexsans_medium_48_mono.h&quot;</span></div>
<div class="line"><span class="keyword">using </span>large_font = constixel::ibmplexsans_medium_48_mono;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">using namespace </span>constixel;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">constexpr</span> std::array&lt;const char *, 5&gt; strings {</div>
<div class="line">        <span class="stringliteral">&quot;ABCDEFGHIJKLM&quot;</span>, <span class="stringliteral">&quot;NOPQRTSUVWXYZ&quot;</span>, <span class="stringliteral">&quot;abcdefghijklm&quot;</span>, <span class="stringliteral">&quot;nopqrstuvwxyz&quot;</span>,<span class="stringliteral">&quot;1234567890&amp;@.,?!&#39;&quot;</span><span class="stringliteral">&quot;&quot;</span></div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">image&lt;format_8bit, 512, 312, 1&gt;</a> <a class="code hl_class" href="classconstixel_1_1image.html">image</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; strings.size(); i++) { </div>
<div class="line">        uint8_t col = color::GREY_RAMP_STOP - <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>(i * 3);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#a8f1119e641fb583a952c3b1a8a8b5212">draw_string_mono</a>&lt;large_font&gt;(16, 48 * <span class="keyword">static_cast&lt;</span>int32_t<span class="keyword">&gt;</span>(i) + 16, strings.at(i), col);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#a58ede242948ae8c59879c8165c43ab49">sixel_to_cout</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aclassconstixel_1_1image_html_a8f1119e641fb583a952c3b1a8a8b5212"><div class="ttname"><a href="classconstixel_1_1image.html#a8f1119e641fb583a952c3b1a8a8b5212">constixel::image::draw_string_mono</a></div><div class="ttdeci">constexpr int32_t draw_string_mono(int32_t x, int32_t y, const char *str, uint8_t col)</div><div class="ttdoc">Draw text at the specified coordinate. The template parameter selects which mono font to use....</div><div class="ttdef"><b>Definition</b> constixel.h:1962</div></div>
</div><!-- fragment --><p><img src="./media/constixel_text.jpg" alt="constixel" title="Example in iTerm" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md7"></a>
Consteval sixel example</h1>
<p>As std::vector can not escape consteval (yet) so we use std::array. Output of this example should be "Actual byte size: 18537" and the sixel image. The binary will contain the evaluated sixel string.</p>
<p>Compile as such:</p>
<div class="fragment"><div class="line">&gt; g++ -fconstexpr-ops-limit=268435456 -std=c++23 constixel.cpp -o constixel -Os</div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;constixel.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">consteval</span> <span class="keyword">auto</span> gen_sixel() {</div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_8bit, 256, 256&gt;</a> <a class="code hl_class" href="classconstixel_1_1image.html">image</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (int32_t y = 0; y &lt; 16; y++) {</div>
<div class="line">        <span class="keywordflow">for</span> (int32_t x = 0; x &lt; 16; x++) {</div>
<div class="line">            <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#abd5c930c3645cb7b5ead82bad22dc7cb">fill_rect</a>(x * 16, y * 16, 16, 16, <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>(y * 16 + x));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::array&lt;char, 32767&gt; sixel;</div>
<div class="line">    <span class="keywordtype">char</span> *ptr = sixel.data();</div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#a3c9bce30fc15b58fa020488d824c8756">sixel</a>([&amp;ptr](<span class="keywordtype">char</span> ch) <span class="keyword">mutable</span> {</div>
<div class="line">        *ptr++ = ch;</div>
<div class="line">    });</div>
<div class="line">    *ptr++ = <span class="charliteral">&#39;\n&#39;</span>;</div>
<div class="line">    *ptr++ = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> sixel;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> sixel = gen_sixel();</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; <span class="stringliteral">&quot;Actual byte size: &quot;</span> &lt;&lt; strlen(sixel.data()) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line">    std::cout &lt;&lt; sixel.data() &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="aclassconstixel_1_1image_html_a3c9bce30fc15b58fa020488d824c8756"><div class="ttname"><a href="classconstixel_1_1image.html#a3c9bce30fc15b58fa020488d824c8756">constixel::image::sixel</a></div><div class="ttdeci">constexpr void sixel(F &amp;&amp;char_out) const</div><div class="ttdoc">Convert the current instance into a sixel stream.</div><div class="ttdef"><b>Definition</b> constixel.h:2377</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
Consteval embedded image data example</h1>
<p>This example will consteval gen_image_1bit() into a std::array, while dynamically generating the sixel string.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;constixel.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;cstring&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">consteval</span> <span class="keyword">auto</span> gen_image_1bit() {</div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_1bit, 256, 256, 1&gt;</a> <a class="code hl_class" href="classconstixel_1_1image.html">image</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (int32_t y = 0; y &lt; 16; y++) {</div>
<div class="line">        <span class="keywordflow">for</span> (int32_t x = 0; x &lt; 16; x++) {</div>
<div class="line">            <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#abd5c930c3645cb7b5ead82bad22dc7cb">fill_rect</a>(x * 16, y * 16, 16, 16, <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>(y + x) &amp; 1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="classconstixel_1_1image.html">image</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">static</span> <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_class" href="classconstixel_1_1image.html">image</a> = gen_image_1bit();</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;image width x height: %d %d x 1bit depth\n&quot;</span>, <span class="keywordtype">int</span>(<a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#a3d2743ef8455345427de36dcf37a5ea4">width</a>()), <span class="keywordtype">int</span>(<a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#ac869cc1a03c0095a9cf65a8fe08ba63b">height</a>()));</div>
<div class="line">    printf(<span class="stringliteral">&quot;image instance byte size: %d\n&quot;</span>, <span class="keywordtype">int</span>(<a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#acc40a104ba00188baea60815963c8252">size</a>()));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> count = 0;</div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#a3c9bce30fc15b58fa020488d824c8756">sixel</a>([&amp;count](<span class="keywordtype">char</span> ch) <span class="keyword">mutable</span> {</div>
<div class="line">        putc(ch, stdout);</div>
<div class="line">        count++;</div>
<div class="line">    });</div>
<div class="line">    putc(<span class="charliteral">&#39;\n&#39;</span>, stdout);</div>
<div class="line"> </div>
<div class="line">    printf(<span class="stringliteral">&quot;sixel byte size: %d\n&quot;</span>, <span class="keywordtype">int</span>(count));</div>
<div class="line">}</div>
<div class="ttc" id="aclassconstixel_1_1image_html_a3d2743ef8455345427de36dcf37a5ea4"><div class="ttname"><a href="classconstixel_1_1image.html#a3d2743ef8455345427de36dcf37a5ea4">constixel::image::width</a></div><div class="ttdeci">static constexpr int32_t width()</div><div class="ttdoc">Width in pixels of the image.</div><div class="ttdef"><b>Definition</b> constixel.h:1670</div></div>
<div class="ttc" id="aclassconstixel_1_1image_html_ac869cc1a03c0095a9cf65a8fe08ba63b"><div class="ttname"><a href="classconstixel_1_1image.html#ac869cc1a03c0095a9cf65a8fe08ba63b">constixel::image::height</a></div><div class="ttdeci">static constexpr int32_t height()</div><div class="ttdoc">Width in pixels of the image.</div><div class="ttdef"><b>Definition</b> constixel.h:1678</div></div>
<div class="ttc" id="aclassconstixel_1_1image_html_acc40a104ba00188baea60815963c8252"><div class="ttname"><a href="classconstixel_1_1image.html#acc40a104ba00188baea60815963c8252">constixel::image::size</a></div><div class="ttdeci">static constexpr size_t size()</div><div class="ttdoc">Size in bytes of the image data.</div><div class="ttdef"><b>Definition</b> constixel.h:1662</div></div>
</div><!-- fragment --><p><img src="./media/constixel_1bit.jpg" alt="constixel" title="Example in iTerm" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md9"></a>
Saving a PNG to disk example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;constixel.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;filesystem&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main() {</div>
<div class="line">    <span class="keyword">static</span> <a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_8bit, 256, 256&gt;</a> <a class="code hl_class" href="classconstixel_1_1image.html">image</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (int32_t y = 0; y &lt; 16; y++) {</div>
<div class="line">        <span class="keywordflow">for</span> (int32_t x = 0; x &lt; 16; x++) {</div>
<div class="line">            <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#abd5c930c3645cb7b5ead82bad22dc7cb">fill_rect</a>(x * 16, y * 16, 16, 16, <span class="keyword">static_cast&lt;</span>uint8_t<span class="keyword">&gt;</span>(y * 16 + x));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;char&gt; out{};</div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">image</a>.<a class="code hl_function" href="classconstixel_1_1image.html#a8f373503c532f2a1be2f18f5c4f38ef2">png</a>([&amp;out](<span class="keywordtype">char</span> ch) <span class="keyword">mutable</span> {</div>
<div class="line">        out.push_back(ch);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">    std::ofstream file(<span class="stringliteral">&quot;constixel.png&quot;</span>, std::ios::binary);</div>
<div class="line">    file.write(<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">char</span>*<span class="keyword">&gt;</span>(out.data()), <span class="keyword">static_cast&lt;</span>std::streamsize<span class="keyword">&gt;</span>(out.size()));</div>
<div class="line">}</div>
<div class="ttc" id="aclassconstixel_1_1image_html_a8f373503c532f2a1be2f18f5c4f38ef2"><div class="ttname"><a href="classconstixel_1_1image.html#a8f373503c532f2a1be2f18f5c4f38ef2">constixel::image::png</a></div><div class="ttdeci">constexpr void png(F &amp;&amp;char_out) const</div><div class="ttdoc">Convert the current instance into a png image.</div><div class="ttdef"><b>Definition</b> constixel.h:2368</div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md10"></a>
API</h1>
<p>The following image formats are available. [Width] is the width in pixels, [Height] is the height in pixels. [Scale] is an optional parameter to specify a scale factor for the sixel output only. For instance setting this to 4 would scale the output of the sixel stream by a factor of 4. [Grayscale] will set the palette to a grayscale palette with black being the first entry in the palette and white being the last entry in the palette.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_1bit, [Width], [Height], [Scale=1]&gt;</a></div>
<div class="line"><a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_2bit, [Width], [Height], [Scale=1], [Grayscale=false]&gt;</a></div>
<div class="line"><a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_4bit, [Width], [Height], [Scale=1], [Grayscale=false]&gt;</a></div>
<div class="line"><a class="code hl_class" href="classconstixel_1_1image.html">constixel::image&lt;constixel::format_8bit, [Width], [Height], [Scale=1], [Grayscale=false]&gt;</a></div>
</div><!-- fragment --><p>The most important member function of image:</p>
<div class="fragment"><div class="line"><span class="comment">// Colors in the fixed internal palette</span></div>
<div class="line"><span class="keyword">enum</span> color : uint8_t {</div>
<div class="line">    BLACK = 0,</div>
<div class="line">    BLACK_OPAQUE = 16,</div>
<div class="line">    WHITE = 1,</div>
<div class="line">    RED = 2,</div>
<div class="line">    GREEN = 3,</div>
<div class="line">    BLUE = 4,</div>
<div class="line">    YELLOW = 5,</div>
<div class="line">    CYAN = 6,</div>
<div class="line">    MAGENTA = 7,</div>
<div class="line">    GREY_80 = 8,</div>
<div class="line">    GREY_60 = 9,</div>
<div class="line">    GREY_40 = 10,</div>
<div class="line">    GREY_20 = 11,</div>
<div class="line">    DARK_RED = 12,</div>
<div class="line">    DARK_GREEN = 13,</div>
<div class="line">    DARK_BLUE = 14,</div>
<div class="line">    DARK_YELLOW = 15</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classconstixel_1_1image.html">image</a> {</div>
<div class="line">    <span class="comment">// Size in bytes of the image buffer</span></div>
<div class="line">    int32_t size();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Width in pixel of the image buffer</span></div>
<div class="line">    int32_t width();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Height in pixels of the image buffer</span></div>
<div class="line">    int32_t height();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Return a reference to the internal pixel buffer</span></div>
<div class="line">    std::array&lt;uint8_t, T&lt;W, H, S&gt;::image_size&gt; &amp;data_ref();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Return a clone of this image, data will be copied.</span></div>
<div class="line">    <a class="code hl_class" href="classconstixel_1_1image.html">image&lt;T, W, H, S, GR&gt;</a> clone();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Clear the image, i.e. set everything to color 0</span></div>
<div class="line">    <span class="keywordtype">void</span> clear();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Copy another image into this instance. Overwrites the contents, no compositing occurs.</span></div>
<div class="line">    <span class="keywordtype">void</span> copy(<span class="keyword">const</span> <a class="code hl_class" href="classconstixel_1_1image.html">image&lt;T, W, H, S, GR&gt;</a> &amp;src);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw monochrome utf8 text. #include a monochrome font and specify the included struct as the template parameter.</span></div>
<div class="line">    <span class="comment">// Rotation can be 0, 90, 180 or 270 degrees</span></div>
<div class="line">    <span class="comment">// Returns the current x caret position in pixels.</span></div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FONT, <span class="keywordtype">bool</span> KERNING = false, ROTATION = DEGREE_0&gt;</div>
<div class="line">    <span class="keyword">constexpr</span> int32_t draw_string_mono(int32_t x, int32_t y, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw smoothed utf8 text. #include a antialiased font and specify the included struct as the template parameter.</span></div>
<div class="line">    <span class="comment">// Rotation can be 0, 90, 180 or 270 degrees</span></div>
<div class="line">    <span class="comment">// Returns the current x caret position in pixels.</span></div>
<div class="line">    <span class="comment">// NOTE 1: This only works with constixel::format_8bit images</span></div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FONT, <span class="keywordtype">bool</span> KERNING = false, ROTATION = DEGREE_0&gt;</div>
<div class="line">    <span class="keyword">constexpr</span> int32_t draw_string_aa(int32_t x, int32_t y, <span class="keyword">const</span> <span class="keywordtype">char</span> *str, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get the width of a utf8 string in pixels. #include a monochrome or grey font and specify the included struct as the template parameter</span></div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> FONT, <span class="keywordtype">bool</span> KERNING = false&gt;</div>
<div class="line">    <span class="keyword">constexpr</span> int32_t string_width(<span class="keyword">const</span> <span class="keywordtype">char</span> *str);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw a line</span></div>
<div class="line">    <span class="keywordtype">void</span> draw_line(int32_t x0, int32_t y0, int32_t x1, int32_t y1, uint8_t col, uint32_t stroke_width = 1);</div>
<div class="line">    <span class="keywordtype">void</span> draw_line(<a class="code hl_struct" href="structconstixel_1_1rect.html">constixel::rect&lt;int32_t&gt;</a> &amp;l, uint8_t col, uint32_t stroke_width = 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw an 1-pixel wide antialiased line with the specified color and thickness.</span></div>
<div class="line">    <span class="comment">// NOTE: This only works with constixel::format_8bit images</span></div>
<div class="line">    <span class="keywordtype">void</span> draw_line_aa(int32_t x0, int32_t y0, int32_t x1, int32_t y1, uint8_t col);</div>
<div class="line">    <span class="keywordtype">void</span> draw_line_aa(<span class="keyword">const</span> <a class="code hl_struct" href="structconstixel_1_1rect.html">rect&lt;int32_t&gt;</a> &amp;<a class="code hl_struct" href="structconstixel_1_1rect.html">rect</a>, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw a filled rectangle</span></div>
<div class="line">    <span class="keywordtype">void</span> fill_rect(int32_t x, int32_t y, int32_t w, int32_t h, uint8_t col);</div>
<div class="line">    <span class="keywordtype">void</span> fill_rect(<a class="code hl_struct" href="structconstixel_1_1rect.html">constixel::rect&lt;int32_t&gt;</a> &amp;r, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw a rounded rectangle</span></div>
<div class="line">    <span class="keywordtype">void</span> fill_round_rect(int32_t x, int32_t y, int32_t w, int32_t h, int32_t radius, uint8_t col);</div>
<div class="line">    <span class="keywordtype">void</span> fill_round_rect(<span class="keyword">const</span> <a class="code hl_struct" href="structconstixel_1_1rect.html">rect&lt;int32_t&gt;</a> &amp;r, int32_t radius, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw a rounded rectangle with antialiasing</span></div>
<div class="line">    <span class="comment">// NOTE: This only works with constixel::format_8bit images</span></div>
<div class="line">    <span class="keywordtype">void</span> fill_round_rect_aa(int32_t x, int32_t y, int32_t w, int32_t h, int32_t radius, uint8_t col);</div>
<div class="line">    <span class="keywordtype">void</span> fill_round_rect_aa(<span class="keyword">const</span> <a class="code hl_struct" href="structconstixel_1_1rect.html">rect&lt;int32_t&gt;</a> &amp;r, int32_t radius, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw a stroked rectangle</span></div>
<div class="line">    <span class="keywordtype">void</span> stroke_rect(int32_t x, int32_t y, int32_t w, int32_t h, uint8_t col, uint32_t stroke_width = 1);</div>
<div class="line">    <span class="keywordtype">void</span> stroke_rect(<a class="code hl_struct" href="structconstixel_1_1rect.html">constixel::rect&lt;int32_t&gt;</a> &amp;r, uint8_t col, uint32_t stroke_width = 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw a filled circle</span></div>
<div class="line">    <span class="keywordtype">void</span> fill_circle(int32_t x, int32_t y, int32_t radius, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Draw a filled circle with antialiasing</span></div>
<div class="line">    <span class="comment">// NOTE 1: This only works with constixel::format_8bit images</span></div>
<div class="line">    <span class="keywordtype">void</span> fill_circle_aa(int32_t x, int32_t y, int32_t radius, uint8_t col);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get closest matching color in the palette for given rgb values</span></div>
<div class="line">    uint8_t get_nearest_color(uint8_t r, uint8_t g, uint8_t b);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get a populated RGBA buffer with the contents of this instance.</span></div>
<div class="line">    <span class="comment">// Color 0 is special and will be set to 0x0000000 in the returned buffer, </span></div>
<div class="line">    <span class="comment">// while all the other colors will be converted to a 0xffBBGGRR format.</span></div>
<div class="line">    std::array&lt;uint32_t, W * H&gt; RGBA_uint32();</div>
<div class="line">    std::array&lt;uint8_t, W * H * 4&gt; RGBA_uint8();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Blit an RGBA (little endian) buffer into this instance. Colors are quantizied to the internal palette. </span></div>
<div class="line">    <span class="comment">// NOTE: This is a slow operation due to the brute force color quantization and will likely not consteval.</span></div>
<div class="line">    <span class="keywordtype">void</span> blit_RGBA(int32_t x, int32_t y, int32_t w, int32_t h, <span class="keyword">const</span> uint8_t *ptr, int32_t iw, int32_t ih, int32_t stride);</div>
<div class="line">    <span class="keywordtype">void</span> blit_RGBA(<span class="keyword">const</span> <a class="code hl_struct" href="structconstixel_1_1rect.html">rect&lt;int32_t&gt;</a> &amp;r, <span class="keyword">const</span> uint8_t *ptr, int32_t iw, int32_t ih, int32_t stride);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Blit an RGBA (little endian) buffer into this instance using line diffusion for better quality.</span></div>
<div class="line">    <span class="comment">// NOTE: This is a slow operation due to the brute force color quantization and will likely not consteval.</span></div>
<div class="line">    <span class="keywordtype">void</span> blit_RGBA_diffused(int32_t x, int32_t y, int32_t w, int32_t h, <span class="keyword">const</span> uint8_t *ptr, int32_t iw, int32_t ih, int32_t stride);</div>
<div class="line">    <span class="keywordtype">void</span> blit_RGBA_diffused(<span class="keyword">const</span> <a class="code hl_struct" href="structconstixel_1_1rect.html">rect&lt;int32_t&gt;</a> &amp;r, <span class="keyword">const</span> uint8_t *ptr, int32_t iw, int32_t ih, int32_t stride);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Blit an RGBA (little endian) buffer into this instance using line diffusion in linear color space for best quality.</span></div>
<div class="line">    <span class="comment">// NOTE: This is a very slow operation due to the brute force color quantization and will likely not consteval.</span></div>
<div class="line">    <span class="keywordtype">void</span> blit_RGBA_diffused_linear(int32_t x, int32_t y, int32_t w, int32_t h, <span class="keyword">const</span> uint8_t *ptr, int32_t iw, int32_t ih, int32_t stride);</div>
<div class="line">    <span class="keywordtype">void</span> blit_RGBA_diffused_linear(<span class="keyword">const</span> <a class="code hl_struct" href="structconstixel_1_1rect.html">rect&lt;int32_t&gt;</a> &amp;r, <span class="keyword">const</span> uint8_t *ptr, int32_t iw, int32_t ih, int32_t stride);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Generate an uncompressed png file. Provide a lambda function in the form of:</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// image.png([](char ch) {</span></div>
<div class="line">    <span class="comment">//    [do something with the character]</span></div>
<div class="line">    <span class="comment">// });</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="keywordtype">void</span> png(F &amp;&amp;charOut);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Convert the current instance into a sixel stream. Provide a lambda function in the form of:</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// image.sixel([](char ch) {</span></div>
<div class="line">    <span class="comment">//    [do something with the character]</span></div>
<div class="line">    <span class="comment">// });</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// Optionally you can provide a rectangle to get a portion of the image only.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="keywordtype">void</span> sixel(F &amp;&amp;charOut);</div>
<div class="line">    <span class="keywordtype">void</span> sixel(F &amp;&amp;charOut, <span class="keyword">const</span> <a class="code hl_struct" href="structconstixel_1_1rect.html">constixel::rect&lt;int32_t&gt;</a> &amp;r);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Convert the current instance into a sixel stream and output it to std::cout</span></div>
<div class="line">    <span class="keywordtype">void</span> sixel_to_cout();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Convert the current instance into a png and display it in iTerm</span></div>
<div class="line">    <span class="keywordtype">void</span> png_to_iterm();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Convert the current instance into a png and display it in a terminal with kitty graphics support</span></div>
<div class="line">    <span class="keywordtype">void</span> png_to_kitty();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Send a escape command to std::cout to clear the screen of a vt100 compatible terminal.</span></div>
<div class="line">    <span class="keywordtype">void</span> vt100_clear();</div>
<div class="line">    <span class="comment">// Send a escape command to std::cout to home the cursor of a vt100 compatible terminal.</span></div>
<div class="line">    <span class="keywordtype">void</span> vt100_home();</div>
<div class="line"></div>
<div class="line">    <span class="keyword">enum</span> device_format {</div>
<div class="line">        STRAIGHT_THROUGH,     </div>
<div class="line">        X_LEFT_TO_RIGHT_1BIT, </div>
<div class="line">        Y_TOP_TO_BOTTOM_1BIT, </div>
<div class="line">        RGB565_8BIT_SERIAL,   </div>
<div class="line">        RGB666_8BIT_SERIAL_1, </div>
<div class="line">        RGB666_8BIT_SERIAL_2  </div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Convert the current instance into a byte stream formatted for embedded displays.</span></div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="classconstixel_1_1image.html#a6b947155fd45a2da9943b07c9d2d131f">convert&lt;device_format&gt;</a>(F &amp;&amp;char_out);</div>
<div class="line">    <span class="keywordtype">bool</span> <a class="code hl_function" href="classconstixel_1_1image.html#a7424b858c178f46521c0bca428a5f6b1">convert_chunk&lt;device_format&gt;</a>(<span class="keywordtype">char</span> *dst, <span class="keywordtype">size_t</span> chunk_size, <span class="keywordtype">size_t</span> &amp;chunk_actual, <span class="keywordtype">size_t</span> &amp;chunk_index);</div>
<div class="line"> </div>
<div class="line">}</div>
<div class="ttc" id="aclassconstixel_1_1image_html_a6b947155fd45a2da9943b07c9d2d131f"><div class="ttname"><a href="classconstixel_1_1image.html#a6b947155fd45a2da9943b07c9d2d131f">constixel::image::convert</a></div><div class="ttdeci">constexpr void convert(F &amp;&amp;char_out)</div><div class="ttdoc">Convert the current instance into a byte stream formatted for embedded displays.</div><div class="ttdef"><b>Definition</b> constixel.h:2509</div></div>
<div class="ttc" id="aclassconstixel_1_1image_html_a7424b858c178f46521c0bca428a5f6b1"><div class="ttname"><a href="classconstixel_1_1image.html#a7424b858c178f46521c0bca428a5f6b1">constixel::image::convert_chunk</a></div><div class="ttdeci">bool convert_chunk(char *dst, size_t chunk_size, size_t &amp;chunk_actual, size_t &amp;chunk_index)</div><div class="ttdoc">Convert the current instance into a byte stream formatted for embedded displays. This function will w...</div><div class="ttdef"><b>Definition</b> constixel.h:2478</div></div>
<div class="ttc" id="astructconstixel_1_1rect_html"><div class="ttname"><a href="structconstixel_1_1rect.html">constixel::rect</a></div><div class="ttdoc">basic rectangle structure</div><div class="ttdef"><b>Definition</b> constixel.h:342</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
